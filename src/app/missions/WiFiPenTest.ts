import { MissionData, MissionState } from "../utils/MissionManager";

/**
 * Defines a WiFi penetration testing mission where players learn
 * to scan, analyze, and compromise a WiFi network.
 */
export const WiFiPenTestMission: MissionData = {
    id: "wifi_pentest",
    title: "WiFi Penetration Test",
    description: "Learn the full process of WiFi security testing. Scan networks, capture handshakes, analyze traffic, and crack WPA2 passwords using real hacking tools.",
    category: "Penetration Testing",
    difficulty: "Intermediate",
    state: MissionState.AVAILABLE,
    objectives: [
        {
            id: "objective_1",
            description: "Scan for wireless networks using 'airodump-ng'",
            completed: false,
            requiredCommand: "airodump-ng wlan0",
            requiredOutput: "CORP_SECURE",
            autoComplete: true
        },
        {
            id: "objective_2",
            description: "Create the directory structure for the pentest",
            completed: false,
            requiredCommand: "mkdir -p /home/user/wifi",
            autoComplete: true
        },
        {
            id: "objective_3",
            description: "Capture packets from CORP_SECURE using 'aireplay-ng'",
            completed: false,
            requiredCommand: "aireplay-ng --deauth 5 -a 00:11:22:33:44:55 wlan0",
            requiredOutput: "Captured handshake",
            autoComplete: true
        },
        {
            id: "objective_4",
            description: "Analyze the captured packets using 'aircrack-ng'",
            completed: false,
            requiredCommand: "aircrack-ng /tmp/captures/capture_CORP_SECURE.cap",
            requiredOutput: "WPA handshake: CORP_SECURE",
            autoComplete: true
        },
        {
            id: "objective_5",
            description: "Create a wordlist file",
            completed: false,
            requiredFile: "/home/user/wifi/wordlist.txt",
            autoComplete: true
        },
        {
            id: "objective_6",
            description: "Crack the WiFi password using 'aircrack-ng'",
            completed: false,
            requiredCommand: "aircrack-ng -w /home/user/wifi/wordlist.txt /tmp/captures/capture_CORP_SECURE.cap",
            requiredOutput: "KEY FOUND! [ corporate2023 ]",
            autoComplete: true
        },
        {
            id: "objective_7",
            description: "Connect to the WiFi network",
            completed: false,
            requiredCommand: "wpa_supplicant -i wlan0 -c <(echo -e 'network={\n    ssid=\"CORP_SECURE\"\n    psk=\"corporate2023\"\n}')",
            requiredOutput: "Successfully connected to CORP_SECURE",
            autoComplete: true
        },
        {
            id: "objective_8",
            description: "Scan for hosts on the network using 'nmap'",
            completed: false,
            requiredCommand: "nmap -sn 192.168.10.0/24",
            requiredOutput: "Nmap scan report",
            autoComplete: true
        },
        {
            id: "objective_9",
            description: "Create a security report",
            completed: false,
            requiredFile: "/home/user/wifi/report.txt",
            expectedFileContent: "CORP_SECURE vulnerability assessment",
            autoComplete: true
        }
    ],
    reward: {
        xp: 250,
        skillPoints: {
            "penetration_testing": 2,
            "network_security": 1
        },
        unlocks: ["advanced_wifi_security"],
        items: ["WiFi Adapter+", "Network Scanner Pro"]
    }
};